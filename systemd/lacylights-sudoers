# Allow lacylights user to run systemd-run for self-updates and MCP updates
# This is needed because the lacylights service has NoNewPrivileges=true
# Also allow systemctl commands needed by update-repos.sh script
# Place this file in /etc/sudoers.d/lacylights
#
# Unit names include timestamps for uniqueness (e.g., lacylights-self-update-20231223-123456)
# The wildcards allow:
#   - Unit names with any timestamp suffix (--unit=lacylights-self-update*)
#   - Additional systemd-run arguments (--description, --on-active, etc.)
#   - /bin/bash -c with the update command
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemd-run --unit=lacylights-self-update* *
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemd-run --unit=lacylights-mcp-update* *
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemctl stop lacylights
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemctl start lacylights
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemctl is-active lacylights
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemctl stop lacylights-frontend
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemctl start lacylights-frontend
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemctl is-active lacylights-frontend
lacylights ALL=(ALL) NOPASSWD: /usr/bin/systemctl daemon-reload
